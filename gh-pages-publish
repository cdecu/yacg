#!/bin/bash
echo "Publishing to gh-pages"
set -e
echo "-Change to branch gh-pages"
git fetch
git pull
git status
git checkout gh-pages
git merge --squash main

echo "-Build"
set +e
rm -rf docs
rm -rf dist
set -e
nx run yacg-ng:build:gh-pages

echo "-Move to Docs"
mkdir docs
mv dist/apps/yacg-ng/browser/*  docs/

echo "-Commit to GitHub"
git add docs
git commit -m "Published"
git push

echo "-Back to main branch"
rm -rf dist
rm -rf docs
rm -rf tmp
git checkout -- *
git checkout main
git pull
git status
